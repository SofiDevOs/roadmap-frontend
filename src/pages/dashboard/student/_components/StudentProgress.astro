---
const progressValue = { value: 32, max: 100, roadmapName: "Frontend" };
---

<article class="dashboard-card">
  <h3>{progressValue.roadmapName}</h3>
  <canvas id="progressChart" width="400" height="400"></canvas>
</article>

<script>
  import { Chart, PieController, ArcElement } from "chart.js";
  Chart.register(PieController, ArcElement);

  const ctx = (
    document.getElementById("progressChart") as HTMLCanvasElement
  ).getContext("2d") as CanvasRenderingContext2D;

  const pie = new Chart(ctx, {
    type: "pie",
    data: {
      labels: ["blue", "red"],

      datasets: [
        {
          label: "progress",
          data: [4, 10 - 4],
          backgroundColor: ["#28a745", "#001a33"],
        },
      ],
    },
    options: {
      elements: {
        arc: {
          backgroundColor: "#000",
          hoverBackgroundColor: "#f1f1f1f1",
        },
      },
    },
    plugins: [
      {
        id: 'tooltip',
        beforeDraw: (chart) => {
          const ctx = chart.ctx;
          const data = chart.data.datasets[0].data;
          const total = data.reduce((a, b) => a + b, 0);

          ctx.save();
          ctx.font = 'bold 16px Arial';
          ctx.textAlign = 'center';
          ctx.fillStyle = '#fff';
          ctx.fillText(`${Math.round((data[0] / total) * 100)}%`, chart.width / 2, chart.height / 2);
          ctx.restore();
        }
      }
    ],
  });
</script>
