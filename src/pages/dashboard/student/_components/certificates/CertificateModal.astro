---
import DownloadIcon from "@shared/assets/icons/DownloadIcon.astro";
import TwitterIcon from "@shared/assets/icons/TwitterIcon.astro";
import LinkedinIcon from "@shared/assets/icons/LinkedinIcon.astro";
import FacebookIcon from "@shared/assets/icons/FacebookIcon.astro";
import LinkIcon from "@shared/assets/icons/LinkIcon.astro";
---

<dialog id="cert-modal">
  <button
    class="modal-close"
    aria-label="Close modal"
    onclick="this.parentElement.close()"
  >
    <svg
      class="close-icon"
      xmlns="http://www.w3.org/2000/svg"
      width="48"
      height="48"
      viewBox="0 0 48 48"
      ><defs
        ><mask id="SVGQNnKUbwa"
          ><g fill="none" stroke="#fff" stroke-linejoin="round" stroke-width="4"
            ><path
              fill="#737373"
              d="M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4S4 12.954 4 24s8.954 20 20 20Z"
            ></path><path
              stroke-linecap="round"
              d="M29.657 18.343L18.343 29.657m0-11.314l11.314 11.314"></path></g
          ></mask
        ></defs
      ><path fill="currentCdolor" d="M0 0h48v48H0z" mask="url(#SVGQNnKUbwa)"
      ></path></svg
    >
  </button>
  <div class="modal-container">
    <div class="cert-info">
      <div class="img-container">
        <img class="modal-img" src="" alt="" />
        <div class="foreground">
          <DownloadIcon class="download-icon" />
          <TwitterIcon class="download-icon" />
          <LinkedinIcon class="download-icon" />
          <FacebookIcon class="download-icon" />
          <LinkIcon class="download-icon" />
        </div>
      </div>
      <time datetime="">
        Fecha de emisi√≥n:
        <span class="modal-date"> </span>
      </time>
    </div>

    <div class="modal-content">
      <h2 class="modal-title"></h2>
      <p class="modal-description"></p>
    </div>
  </div>
</dialog>

<!-- https://x.com/intent/tweet?text=Hindley-Milner%20en%20JavaScript%20by%20%40yeion7%20https%3A%2F%2Fmedium.com%2Fentendiendo-javascript%2Fhindley-milner-en-javascript-7ef0b0370818%3Fsource%3Dsocial.tw -->
<script>
  const certificatesGrid = document.querySelector(".certificates-grid");
  const modal = document.querySelector("#cert-modal") as HTMLDialogElement;
  const modalImg = document.querySelector(".modal-img") as HTMLImageElement;
  const modalTitle = document.querySelector(".modal-title") as HTMLElement;
  const modalDate = document.querySelector(".modal-date") as HTMLElement;
  const modalDescription = document.querySelector(
    ".modal-description"
  ) as HTMLElement;

  certificatesGrid?.addEventListener("click", (e) => {
    const element = e.target as HTMLElement;
    console.log(element);

    if (!element.classList.contains("cert-card")) return;

    const image =
      (element.querySelector(".cert-img") as HTMLImageElement)?.src || "";
    const title = element.querySelector(".cert-title") as HTMLElement;
    const description = element.dataset.description;
    const date = element.dataset.date;
    modalImg.src = image;
    modalImg.alt = description || "Certificate Image";
    modalTitle.innerText = title?.innerText || "Certificate";
    modalDescription.innerText = description || "";
    modalDate.innerText = date || "";
    modalDate.setAttribute("datetime", date || "");
    modal.showModal();
  });
</script>

<style>
  #cert-modal {
    border: none;
    width: 100%;
    height: 100%;
    margin: auto;
    background: #1d2838;
    border-radius: 15px;
  }
  #cert-modal[open]::backdrop {
    background: rgba(0, 0, 0, 0.281);
    backdrop-filter: blur(25px);
  }
  #cert-modal::backdrop {
    background: rgba(0, 0, 0, 0.281);
    backdrop-filter: blur(25px);
  }
  .modal-close {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: none;
    border: none;
    cursor: pointer;
  }
  .close-icon {
    fill: var(--accent-color);
    width: 3.5rem;
    height: 3.5rem;
  }
  .modal-container {
    display: grid;
    grid-template-columns: 1fr 60rem;
    padding: 2rem;
    gap: 1.5rem;
  }
  .cert-info {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  .img-container {
    width: 100%;
    height: 85dvh;
    overflow: hidden;
    border-radius: 12px;
    position: relative;
  }

  .modal-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  .foreground {
    transition-behavior: allow-discrete;
    transition:
      display .5s ease-in-out,
      opacity .5s ease-in-out;
  }
  .foreground {
    position: absolute;
    bottom: 3rem;
    right: 3rem;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 12px;
    padding: 1rem;
    display: none;
  }
  .img-container:hover .foreground {
    gap: 1rem;
    opacity: 1;
    display: flex;
    @starting-style {
      opacity: 0;
    }
  }
  .download-icon {
    cursor: pointer;
    width: 2.5rem;
    height: 2.5rem;
    color: white;
  }
  time {
    color: white;
    font-size: 1.5rem;
  }
  .modal-date {
    color: var(--accent-color);
    margin-left: 0.5rem;
  }

  .modal-title {
    color: var(--accent-color);
    font-size: 3rem;
    margin: 0.5rem 0;
  }
  .modal-description {
    font-size: 1.6rem;
    margin-top: 3rem;
  }
</style>
