---
import LayoutStudents from "@pages/dashboard/_LayoutStudents.astro";
import LessonTrivia from "./_components/lesson-types/LessonTrivia.astro";
import LessonVideo from "./_components/lesson-types/LessonVideo.astro";
import LessonAccordion from "./_components/LessonAccordion.astro";
import type { Lessons } from "./_types";
import sampleData from "./lessonsSampleData.json";

const { leccion } = Astro.params;
const lessonUrl = Astro.url.searchParams;
const query = lessonUrl.get("lessonType");
const lessonData = sampleData as Lessons;

const lessonsTypes = {
  "trivia": LessonTrivia,
  "video": LessonVideo
}
const LessonType = lessonsTypes[query as keyof typeof lessonsTypes ] || LessonVideo;
---
<LayoutStudents>
  <LessonType {leccion} />
  <aside slot="sidebar-right" class="sidebar-resources">
    {Object.keys(lessonData).map((section: string)=>(
      <LessonAccordion sectionTitle={section}  lessonList={lessonData[section]}/>
    ) )}
  </aside>
</LayoutStudents>

<style is:global>
  :root {
    --sidebar-min-width: 40rem;
    --sidebar-padding: 2rem;
  }
</style>

<style is:inline>
main{
  padding-bottom: 0;
}
.lesson{
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 3rem;
}

.sidebar-resources {
    min-width: var(--sidebar-min-width);
    grid-area: sidebar-right;
    display: flex;
    flex-direction: column;
    min-height: 100dvh;
    background-color: var(--bg-color);
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    border-left: 1px solid #e6e0ee14;ÃŸ
}
.lesson-content{
  width: 100%;
  max-width:1080px;
  align-self:start;
}
.lesson-title{
  color: var(--accent-color);
  margin-bottom: 2rem;
}
</style>
