---
interface Props {
  sectionTitle: string;
  lessonList: Array<{ title: string; slug: string, progress?: number }>;
}
const { leccion } = Astro.params;
const { sectionTitle, lessonList } = Astro.props;
const isOpen = lessonList.some(({ slug }) => slug === leccion);
---

<details open={isOpen} class="acordion">
  <summary class="acordion-sumary">{sectionTitle}</summary>
  <ol class="acordion-list">
    {
    lessonList.map(({ slug, title, progress }) => {
      const isCompleted = progress === 100;
      const isCurrent = leccion === slug;
      return (
        <li
          class:list={[
            "acordion-item", 
            {"is-completed":isCompleted},
            {"is-current":isCurrent}
          ]}
          style={`--progress: ${progress ?? 0}`} 
        >
          <a class="acordion-link" href={slug}>
            {title}
          </a>
        </li>
      )})
    }
  </ol>
</details>

<style>

  .acordion {
    color: var(--accent-color);
    border: 0.5px solid rgb(128 128 128 / 11%);
    padding: 2rem;
    cursor: pointer;
  }
  .acordion-sumary {
    font-size: 1.7rem;
  }
  .acordion-item {
    padding: 1rem;
    position: relative;
    
    &:not(.is-completed)::before {
      content: "";
      display: inline-block;
      height: 1.5rem;
      width: 1.5rem;
      margin-right: 1rem;
      border-radius: 50%;
      background:
      radial-gradient(circle, var(--bg, #111) 60%, transparent 61%),
      conic-gradient(
        from -90deg,
        var(--accent-color) 0% calc(var(--progress, 0%) * 1%),
        var(--secondary-color) calc(var(--progress, 0%) * 1%) 100%
      );
      -webkit-mask: none;
      mask: none;
    }

    &::before {
      display: inline-block;
      width: 1.5rem;
      height: 1.5rem;
      vertical-align: -0.125em;
      margin-right: 1rem;
      content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2048 2048'%3E%3Cpath fill='%23FFD60A' d='m1491 595l90 90l-749 749l-365-365l90-90l275 275zM1024 0q141 0 272 36t245 103t207 160t160 208t103 245t37 272q0 141-36 272t-103 245t-160 207t-208 160t-245 103t-272 37q-141 0-272-36t-245-103t-207-160t-160-208t-103-244t-37-273q0-141 36-272t103-245t160-207t208-160T751 37t273-37m0 1920q123 0 237-32t214-90t182-141t140-181t91-214t32-238q0-123-32-237t-90-214t-141-182t-181-140t-214-91t-238-32q-123 0-237 32t-214 90t-182 141t-140 181t-91 214t-32 238q0 123 32 237t90 214t141 182t181 140t214 91t238 32'/%3E%3C/svg%3E");
    }

    &.is-current {
      background: var(--secondary-color);
      border-radius: 0.8rem;
    }
  }
  .acordion-item:hover {
    background: var(--secondary-color);
  }

  .acordion-link {
    font-size: 1.4rem;
  }
</style>
